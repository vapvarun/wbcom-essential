!function(){"use strict";function e(e){const n=e.querySelector(".user-wrap-container");if(n){const e=n.querySelector(".user-link");e&&e.addEventListener("click",function(e){const t=e.target;(t.classList.contains("fa-angle-down")||t.classList.contains("user-name"))&&(e.preventDefault(),n.classList.toggle("is-open"))})}const o=e.querySelector(".header-search-link"),a=e.querySelector(".wbcom-header-bar-search-overlay"),c=e.querySelector(".wbcom-search-close");o&&a&&o.addEventListener("click",function(t){t.preventDefault(),e.classList.add("search-active");const n=a.querySelector('input[type="search"], input[type="text"]');n&&setTimeout(()=>n.focus(),100)}),c&&a&&(c.addEventListener("click",function(t){t.preventDefault(),e.classList.remove("search-active")}),document.addEventListener("keydown",function(t){"Escape"===t.key&&e.classList.contains("search-active")&&e.classList.remove("search-active")}),a.addEventListener("click",function(t){t.target===a&&e.classList.remove("search-active")})),document.addEventListener("click",function(t){n&&!n.contains(t.target)&&n.classList.remove("is-open"),e.querySelectorAll(".notification-wrap.menu-item-has-children").forEach(function(e){e.contains(t.target)||e.classList.remove("is-open")})});const r=e.querySelector(".buddyx-switch-mode");r&&("true"===localStorage.getItem("wbcom-dark-mode")&&(document.body.classList.add("dark-mode"),r.classList.add("is-active")),r.addEventListener("click",function(e){e.preventDefault();const t=document.body.classList.toggle("dark-mode");r.classList.toggle("is-active",t),localStorage.setItem("wbcom-dark-mode",t.toString())})),function(e){const n=e.querySelector(".notifications-wrap");if(!n)return;const o=n.querySelector(".mark-read-all");o&&o.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),"all"===this.getAttribute("data-notification-id")&&t("all",e)}),n.querySelectorAll(".mark-read.action-unread").forEach(function(n){n.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();const o=this.getAttribute("data-notification-id");o&&t(o,e,this)})})}(e)}function t(e,t,o){if("undefined"==typeof bp||void 0===bp.ajax)return void function(e,t,o){const a="undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",c=new FormData;c.append("action","buddypress_mark_notification_read"),c.append("notification_id",e);const r=document.querySelector('input[name="_wpnonce"]');r&&c.append("_wpnonce",r.value),fetch(a,{method:"POST",credentials:"same-origin",body:c}).then(e=>e.json()).then(a=>{a.success&&n(e,t,o)}).catch(a=>{console.error("Error marking notification as read:",a),n(e,t,o)})}(e,t,o);const a={action:"buddypress_mark_notification_read",notification_id:e,_wpnonce:bp.ajax.nonce};fetch(bp.ajax.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a).toString()}).then(e=>e.json()).then(a=>{a.success&&n(e,t,o)}).catch(e=>{console.error("Error marking notification as read:",e)})}function n(e,t,n){const o=t.querySelector(".notifications-wrap");if(o)if("all"===e){o.querySelectorAll(".dropdown-item.unread").forEach(function(e){e.classList.remove("unread")});const e=o.querySelector(".mark-read-all");e&&(e.style.display="none");const t=o.querySelector(".count");t&&(t.style.display="none")}else{if(n){const e=n.closest(".dropdown-item");e&&e.classList.remove("unread")}const e=o.querySelector(".count");if(e){const t=parseInt(e.textContent,10);if(t>1)e.textContent=t-1;else{e.style.display="none";const t=o.querySelector(".mark-read-all");t&&(t.style.display="none")}}}}function o(){document.querySelectorAll(".wbcom-essential-header-bar").forEach(e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}();