!function(){"use strict";function e(e){const n=e.querySelector(".user-wrap-container");if(n){const e=n.querySelector(".user-link");e&&e.addEventListener("click",function(e){const t=e.target;(t.classList.contains("fa-angle-down")||t.classList.contains("user-name"))&&(e.preventDefault(),n.classList.toggle("is-open"))})}const a=e.querySelector(".header-search-link"),r=e.querySelector(".wbcom-header-bar-search-overlay"),o=e.querySelector(".wbcom-search-close");a&&r&&a.addEventListener("click",function(t){t.preventDefault(),e.classList.add("search-active");const n=r.querySelector('input[type="search"], input[type="text"]');n&&setTimeout(()=>n.focus(),100)}),o&&r&&(o.addEventListener("click",function(t){t.preventDefault(),e.classList.remove("search-active")}),document.addEventListener("keydown",function(t){"Escape"===t.key&&e.classList.contains("search-active")&&e.classList.remove("search-active")}),r.addEventListener("click",function(t){t.target===r&&e.classList.remove("search-active")})),document.addEventListener("click",function(t){n&&!n.contains(t.target)&&n.classList.remove("is-open"),e.querySelectorAll(".notification-wrap.menu-item-has-children").forEach(function(e){e.contains(t.target)||e.classList.remove("is-open")})});const c=e.querySelector(".buddyx-switch-mode");c&&("true"===localStorage.getItem("wbcom-dark-mode")&&(document.body.classList.add("dark-mode"),c.classList.add("is-active")),c.addEventListener("click",function(e){e.preventDefault();const t=document.body.classList.toggle("dark-mode");c.classList.toggle("is-active",t),localStorage.setItem("wbcom-dark-mode",t.toString())})),function(e){const n=e.querySelector(".notifications-wrap");if(!n)return;const a=n.querySelector(".mark-read-all");a&&a.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),"all"===this.getAttribute("data-notification-id")&&t("all",e)}),n.querySelectorAll(".mark-read.action-unread").forEach(function(n){n.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();const a=this.getAttribute("data-notification-id");a&&t(a,e,this)})})}(e),function(e){const t=e.querySelector(".header-cart-drawer-trigger"),n=e.querySelector(".header-cart-drawer");if(!t||!n)return;const a=n.querySelector(".header-cart-drawer__overlay"),r=n.querySelector(".header-cart-drawer__close");function o(){n.setAttribute("aria-hidden","true"),document.body.classList.remove("header-cart-drawer-open")}t.addEventListener("click",function(e){e.preventDefault(),n.setAttribute("aria-hidden","false"),document.body.classList.add("header-cart-drawer-open")}),a&&a.addEventListener("click",function(e){e.preventDefault(),o()}),r&&r.addEventListener("click",function(e){e.preventDefault(),o()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&"false"===n.getAttribute("aria-hidden")&&o()})}(e)}function t(e,t,a){if("undefined"==typeof bp||void 0===bp.ajax)return void function(e,t,a){const r="undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",o=new FormData;o.append("action","buddypress_mark_notification_read"),o.append("notification_id",e);const c=document.querySelector('input[name="_wpnonce"]');c&&o.append("_wpnonce",c.value),fetch(r,{method:"POST",credentials:"same-origin",body:o}).then(e=>e.json()).then(r=>{r.success&&n(e,t,a)}).catch(r=>{console.error("Error marking notification as read:",r),n(e,t,a)})}(e,t,a);const r={action:"buddypress_mark_notification_read",notification_id:e,_wpnonce:bp.ajax.nonce};fetch(bp.ajax.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(r).toString()}).then(e=>e.json()).then(r=>{r.success&&n(e,t,a)}).catch(e=>{console.error("Error marking notification as read:",e)})}function n(e,t,n){const a=t.querySelector(".notifications-wrap");if(a)if("all"===e){a.querySelectorAll(".dropdown-item.unread").forEach(function(e){e.classList.remove("unread")});const e=a.querySelector(".mark-read-all");e&&(e.style.display="none");const t=a.querySelector(".count");t&&(t.style.display="none")}else{if(n){const e=n.closest(".dropdown-item");e&&e.classList.remove("unread")}const e=a.querySelector(".count");if(e){const t=parseInt(e.textContent,10);if(t>1)e.textContent=t-1;else{e.style.display="none";const t=a.querySelector(".mark-read-all");t&&(t.style.display="none")}}}}function a(){document.querySelectorAll(".wbcom-essential-header-bar").forEach(e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a()}();