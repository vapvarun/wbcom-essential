document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('.wbcom-essential-login-form__form[data-ajax="true"]').forEach(e=>{e.addEventListener("submit",async t=>{t.preventDefault();const a=e.querySelector(".wbcom-essential-login-form__message"),s=e.querySelector(".wbcom-essential-login-form__button"),n=s.querySelector(".wbcom-essential-login-form__button-text"),o=s.querySelector(".wbcom-essential-login-form__button-loading"),d=new FormData(e);d.append("action","wbcom_essential_ajax_login"),s.disabled=!0,n.hidden=!0,o.hidden=!1,a.hidden=!0,a.classList.remove("is-error","is-success");try{const e=await fetch(wbcomEssentialLogin.ajaxUrl,{method:"POST",body:d,credentials:"same-origin"}),t=await e.json();t.success?(a.textContent=t.data.message,a.classList.add("is-success"),a.hidden=!1,t.data.redirect&&setTimeout(()=>{window.location.href=t.data.redirect},500)):(a.textContent=t.data.message||"An error occurred. Please try again.",a.classList.add("is-error"),a.hidden=!1,s.disabled=!1,n.hidden=!1,o.hidden=!0)}catch(e){a.textContent="An error occurred. Please try again.",a.classList.add("is-error"),a.hidden=!1,s.disabled=!1,n.hidden=!1,o.hidden=!0}})})});