/**
 * Timeline Block - Frontend Styles
 *
 * @package wbcom-essential
 */

.wbcom-essential-timeline {
	// Layout defaults
	--bar-thickness: 4px;
	--icon-container-size: 60px;
	--content-padding: 24px;
	--content-box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
	--content-border: none;
	--date-font-size: 14px;
	--title-font-size: 20px;
	--text-font-size: 16px;
	--item-spacing: 40px;
	--image-border-radius: 8px;

	// Default color fallbacks (used when custom colors applied via inline styles)
	--bar-color: #e2e8f0;
	--content-background: #f7fafc;
	--icon-bg: #3182ce;
	--icon-color: #ffffff;
	--date-color: #718096;
	--title-color: #1a202c;
	--text-color: #4a5568;

	/**
	 * Theme Colors Mode
	 * Maps theme CSS variables to block-specific variables.
	 */
	&.use-theme-colors {
		--bar-color: var(--wbcom-border-color, var(--wbcom-color-base-2, #e2e8f0));
		--content-background: var(--wbcom-card-bg, var(--wbcom-color-base, #f7fafc));
		--icon-bg: var(--wbcom-color-primary, #3182ce);
		--icon-color: var(--wbcom-color-base, #ffffff);
		--date-color: var(--wbcom-meta-color, var(--wbcom-color-contrast-2, #718096));
		--title-color: var(--wbcom-heading-color, var(--wbcom-color-contrast, #1a202c));
		--text-color: var(--wbcom-text-color, var(--wbcom-color-contrast-2, #4a5568));

		// Apply theme colors to elements
		.wbcom-timeline-icon {
			background-color: var(--icon-bg);
			color: var(--icon-color);
		}

		.wbcom-timeline-content {
			background-color: var(--content-background);
		}

		.wbcom-timeline-date {
			color: var(--date-color);
		}

		.wbcom-timeline-title {
			color: var(--title-color);
		}

		.wbcom-timeline-text {
			color: var(--text-color);
		}
	}

	padding: 40px 0;

	.wbcom-timeline-container {
		position: relative;
		padding: 0;

		// Vertical bar
		&::before {
			content: '';
			position: absolute;
			top: 0;
			left: calc(var(--icon-container-size) / 2 - var(--bar-thickness) / 2);
			height: 100%;
			width: var(--bar-thickness);
			background-color: var(--bar-color);
		}
	}

	.wbcom-timeline-block {
		display: flex;
		position: relative;
		z-index: 1;
		margin-bottom: var(--item-spacing);

		&:last-child {
			margin-bottom: 0;
		}
	}

	.wbcom-timeline-icon {
		display: flex;
		justify-content: center;
		align-items: center;
		flex-shrink: 0;
		z-index: 9;
		text-align: center;
	}

	.wbcom-timeline-content {
		flex-grow: 1;
		position: relative;
		margin-left: 30px;
		padding: var(--content-padding);
		box-shadow: var(--content-box-shadow);
		border: var(--content-border);

		// Arrow pointer
		&::before {
			content: '';
			position: absolute;
			top: 20px;
			right: 100%;
			width: 0;
			height: 0;
			border: 10px solid transparent;
			border-right-color: inherit;
			display: none;
		}

		&.show-arrow::before {
			display: block;
			border-right-color: var(--content-background);
		}

		p:last-of-type {
			margin-bottom: 0;
		}
	}

	.wbcom-timeline-image {
		// Negative margins to extend beyond content padding for full-width images
		margin: calc(var(--content-padding) * -1);
		margin-bottom: 16px;
		overflow: hidden;

		img {
			width: 100%;
			height: auto;
			// Top corners rounded, bottom corners square (connects to content)
			border-radius: var(--image-border-radius) var(--image-border-radius) 0 0;
			display: block;
			object-fit: cover;
		}
	}

	.wbcom-timeline-date {
		display: block;
		font-size: var(--date-font-size);
		font-weight: 600;
		margin-bottom: 8px;
	}

	.wbcom-timeline-title {
		margin: 0 0 12px;
		padding: 0;
		font-size: var(--title-font-size);
		font-weight: 600;
		line-height: 1.3;

		&::before,
		&::after {
			display: none;
		}
	}

	.wbcom-timeline-text {
		margin: 0;
		font-size: var(--text-font-size);
		line-height: 1.7;
	}
}

// Two-column layout
.wbcom-timeline-two-column {
	@media screen and (min-width: 1025px) {
		.wbcom-timeline-container::before {
			left: 50%;
			transform: translateX(-50%);
		}

		.wbcom-timeline-block {
			justify-content: flex-end;
			position: relative;

			// Icon positioned absolutely at center
			.wbcom-timeline-icon {
				position: absolute;
				left: 50%;
				top: 20px;
				transform: translateX(-50%);
				margin: 0;
			}

			.wbcom-timeline-content {
				width: calc(50% - var(--icon-container-size) / 2 - 30px);
				flex-grow: 0;
				margin-left: 0;
				margin-right: calc(50% + var(--icon-container-size) / 2 + 30px);
			}

			// Odd items (left side content)
			&.odd {
				.wbcom-timeline-content::before {
					right: auto;
					left: 100%;
					border-right-color: transparent;
					border-left-color: inherit;
				}

				.wbcom-timeline-content.show-arrow::before {
					border-left-color: var(--content-background);
				}
			}

			// Even items (right side content)
			&.even {
				justify-content: flex-start;

				.wbcom-timeline-content {
					margin-right: 0;
					margin-left: calc(50% + var(--icon-container-size) / 2 + 30px);
				}

				.wbcom-timeline-content::before {
					right: 100%;
					left: auto;
				}

				.wbcom-timeline-content.show-arrow::before {
					border-right-color: var(--content-background);
				}
			}
		}
	}

	@media screen and (max-width: 1024px) {
		.wbcom-timeline-block {
			.wbcom-timeline-icon {
				position: static;
				transform: none;
				margin-left: 0;
				margin-right: 0;
			}

			.wbcom-timeline-content {
				width: auto;
				flex-grow: 1;
				margin-left: 30px;
				margin-right: 0;

				&::before {
					right: 100%;
					left: auto;
					border-left-color: transparent;
				}

				&.show-arrow::before {
					border-right-color: var(--content-background);
				}
			}
		}
	}
}

// Animation classes
.wbcom-timeline-animated {
	.wbcom-timeline-icon,
	.wbcom-timeline-content {
		opacity: 0;
		transform: translateY(30px);
		transition: opacity 0.6s ease, transform 0.6s ease;
	}

	.wbcom-timeline-icon.animate-in,
	.wbcom-timeline-content.animate-in {
		opacity: 1;
	}

	.wbcom-timeline-content.animate-in {
		transform: translateY(0);
	}

	@media screen and (min-width: 1025px) {
		&.wbcom-timeline-two-column {
			.wbcom-timeline-block.odd .wbcom-timeline-content {
				transform: translateX(30px);

				&.animate-in {
					transform: translateX(0);
				}
			}

			.wbcom-timeline-block.even .wbcom-timeline-content {
				transform: translateX(-30px);

				&.animate-in {
					transform: translateX(0);
				}
			}
		}
	}
}

// Responsive
@media screen and (max-width: 767px) {
	.wbcom-essential-timeline {
		padding: 20px 0;

		.wbcom-timeline-content {
			margin-left: 20px;
			padding: 16px;
		}

		.wbcom-timeline-title {
			font-size: 1.1rem;
		}

		.wbcom-timeline-text {
			font-size: 0.9rem;
		}
	}
}
